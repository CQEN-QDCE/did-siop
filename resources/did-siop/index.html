<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <title>DID AuthN profile for OpenID Connect</title>
    <link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">
    <style>
      #subtitle ~ h2,
      .copyright,
      #sotd p:first-of-type {
        display: none;
      }
    </style>
    <script src='https://www.w3.org/Tools/respec/respec-w3c-common' class='remove'></script>
    <script class='remove'>
      var respecConfig = {
        subtitle: "DIF Working Group Draft",
        wg: "Authentication Working Group",
        logos: [{
          src: 'https://raw.githubusercontent.com/decentralized-identity/decentralized-identity.github.io/master/images/logo-large.png',
          href: "https://identity.foundation/",
          alt: "Decentralized Identity Foundation",
          width: 200,
          id: 'dif-logo',
        }],
        editors: [{
          name: "Oliver Terbu",
          url: "https://www.linkedin.com/in/oliver-terbu/",
          company: "ConsenSys",
          companyURL: "https://consensys.net/"
        }
        ],
        authors: [{
          name: "Oliver Terbu",
          url: "https://www.linkedin.com/in/oliver-terbu/",
          company: "uPort (ConsenSys)",
          companyURL: "https://uport.me/"
        },
        {
          name: "Ivan Basart",
          url: "https://www.linkedin.com/in/ivanbasart/",
          company: "Validated ID",
          companyURL: "https://www.validatedid.com/"
        },
        {
          name: "Kyle Den Hartog",
          url: "https://www.linkedin.com/in/kyledenhartog/",
          company: "Mattr",
          companyURL: "https://mattr.global/"
        },
        {
          name: "Christian Lundkvist",
          url: "https://www.linkedin.com/in/chrislun/",
          company: "ConsenSys",
          companyURL: "https://consensys.net/"
        },
        {
          name: "David Stark",
          url: "https://www.linkedin.com/in/david-stark-a3bb40/",
          company: "SecureKey",
          companyURL: "https://securekey.com/"
        },
        {
          name: "Dmitri Zagidulin",
          url: "https://www.linkedin.com/in/dzagidulin/",
          company: "Digital Bazaar",
          companyURL: "https://digitalbazaar.com/"
        },
        {
          name: "Danny Strockis",
          url: "https://www.linkedin.com/in/dannystrockis/",
          company: "Microsoft",
          companyURL: "https://www.microsoft.com/en-us/security/technology/own-your-identity"
        },
        {
          name: "Orie Steele",
          url: "https://www.linkedin.com/in/or13b/",
          company: "Transmute",
          companyURL: "https://www.transmute.industries/"
        }],
        github: "https://github.com/decentralized-identity/did-siop",
        edDraftURI: "TBD",
        shortName: "did-siop"
      };
    </script>
</head>

<body>

<section id="abstract">
    <h2>Abstract</h2>
    <p>
        This specification defines the "DID AuthN profile for OpenID Connect" that is a DID AuthN flavor to use OIDC together with the strong decentralization, privacy and security guarantees of DID for everyone who wants to have a generic way to integrate Identity Wallets into their web applications.
    </p>
</section>

<section id='sotd'>
    <p>
        DID SIOP is a draft specification being developed within the <a href="https://identity.foundation">Decentralized Identity Foundation</a> (DIF), and intended for registration with IANA as a Well-Known resource. This spec will be updated to reflect relevant changes, and participants are encouraged to contribute at the following repository location: <a href="https://github.com/decentralized-identity/did-siop">https://github.com/decentralized-identity/did-siop</a>
    </p>
</section>

<section class="informative">
    <h1>
        Introduction
    </h1>

    <p>
        An everyday use case that the SSI community identified is the sign-up or login with web applications. Nowadays, this is often achieved through social login schemes such as Google Sign-In. While the SSI community has serious concerns about social login, the underlying protocol, OIDC, does not have these flaws by design. DID AuthN provides great potential by leveraging an Identity Wallet, e.g., as a smartphone app, on the web. This will increase and preserve the userâ€™s privacy by preventing third-parties from having the ability to track which web applications a user is interacting with.
    </p>
    <p class="note">
        While this specification focuses on the integration of Identity Wallets in the form of browser extensions/ plugins, or smartphone apps, it does not prevent implementers using the proposed flow in different scenarios as well, e.g., between two web services with pre-populated DIDs.
    </p>

    <section class="informative">
        <h2>
            Purpose
        </h2>

        <p>
            The main purpose is to sign up with/ login to an RP, i.e., web application. It assumes the user operates a mobile or desktop browser or a browser-based app that can respond to SIOP requests according to this specification.
        </p>

        <p class="note">
            The SIOP flow is conducted peer-to-peer between the RP and the SIOP. This could be used to authenticate holders based on their DID, to setup/ bootstrap a DID Comm connection with any DID routing that you may need, or to provide the <code>login_hint</code> to an OpenID Connect service in the DID Document supporting the Client-Initiated Backend Channel (CIBA) flow.
        </p>

    </section>

    <section class="informative">
        <h2>
            Goals
        </h2>

        <p>
            The main goals of this specification are:
        </p>
        <ul>
            <li>Staying backward compatible with existing OIDC clients (RPs) and OPs that implement the SIOP specification which is part of the OIDC core specification to reach a broader community.</li>
            <li>Adding validation rules for OIDC clients (RPs) that have DID AuthN support to make full use of DIDs.</li>
            <li>Not relying on any intermediary such as a traditional centralized public or private OP while still being OIDC compliant.</li>
        </ul>

    </section>

</section>

<section class="informative">
    <h1>Terminology</h1>
    <table class="simple">
        <thead>
        <tr>
            <th style="min-width: 8em;">Term</th>
            <th>Description</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td id="decentralized-identifier">Decentralized Identifier (DID)</td>
            <td>Unique ID string and PKI metadata document format for describing the cryptographic keys and other fundamental PKI values linked to a unique, user-controlled, self-sovereign identifier in a DID registry (i.e. blockchain, distributed ledger, etc.).</td>
        </tr>
        <tr>
            <td id="jwt">JWT</td>
            <td>JSON Web Token, as specified in <a href="https://tools.ietf.org/html/rfc7797">IETF RFC 7797</a></td>
        </tr>
        <tr>
            <td id="jwe">JWE</td>
            <td>JSON Web Encryption, as specified in <a href="https://tools.ietf.org/html/rfc7516">IETF RFC 7516</a></td>
        </tr>
        <tr>
            <td id="jws">JWS</td>
            <td>JSON Web Signature, as specified in <a href="https://tools.ietf.org/html/rfc7515">IETF RFC 7515</a></td>
        </tr>
        <tr>
            <td id="jwk">JWK</td>
            <td>JSON Web Key, as specified in <a href="https://tools.ietf.org/html/rfc7517">IETF RFC 7517</a></td>
        </tr>
        <tr>
            <td id="jwks">JWKS</td>
            <td>JWK Set, as specified in <a href="https://tools.ietf.org/html/rfc7517">IETF RFC 7517</a></td>
        </tr>

        <tr>
            <td id="oidc">OIDC</td>
            <td>OpenID Connect, as specified in <a href="https://openid.net/specs/openid-connect-core-1_0.html">OpenID Connect Core 1.0 incorporating errata set 1</a></td>
        </tr>
        <tr>
            <td id="op">OP</td>
            <td>OpenID Provider, as specified in <a href="https://openid.net/specs/openid-connect-core-1_0.html">OpenID Connect Core 1.0 incorporating errata set 1</a></td>
        </tr>
        <tr>
            <td id="siop">SIOP</td>
            <td>Self-Issued OpenID Provider, as specified in <a href="https://openid.net/specs/openid-connect-core-1_0.html#SelfIssued">OpenID Connect Core 1.0 incorporating errata set 1</a></td>
        </tr>
        <tr>
            <td id="rp">RP</td>
            <td>Relying Party, as used in <a href="https://openid.net/specs/openid-connect-core-1_0.html">OpenID Connect Core 1.0 incorporating errata set 1</a></td>
        </tr>
        <tr>
            <td id="identity-wallet">Identity Wallet</td>
            <td>TBD</td>
        </tr>
        <tr>
            <td id="ssi">Self-sovereign Identity</td>
            <td>TBD</td>
        </tr>

        </tbody>
    </table>
</section>

<section class="normative">
    <h1>Protocol Flow</h1>
    <p>
        This specification assumes, the user is operating a mobile or desktop browser to visit a web application or uses a browser-based app.
    </p>
    <p>
        First, the user clicks on the sign up or login UX element. The RP will then generate the redirect to <code>openid://&lt;SIOP Request&gt;</code> which will be handled by the SIOP.
    </p>

    <p class="note">
        On the mobile device, this would open the Identity Wallet app, e.g., uport, connect.me. On the desktop browser, this would either show a QR code which can be scanned by the Identity Wallet app or a redirect to <code>openid://&lt;SIOP Request&gt;</code> that for instance could be handled by a browser extension/ plugin implementing the SIOP.
    </p>

    <p>
        The SIOP will generate the <code>&lt;SIOP Response&gt;</code> based on the specific DID method that is supported. The <code>&lt;SIOP Response&gt;</code> will be signed and optionally encrypted and will be provided according to the requested response mode.
    </p>

    <p>
        This specification does not explicitly support any intermediate hubs or cloud agents. It is meant to be a protocol to exchange the DID. You could then interact with a hub/ cloud agent using the service endpoint in the DID Document.
    </p>

    <p>
        Unlike the Authorization Code Flow, the SIOP will not return an access token to the RP. If this is desired, this could be achieved by following the aforementioned CIBA flow in addition. SIOP also differs from Authorization Code Flow by not relying on a centralized and known OP. The SIOP can be unknown to the RP until the user starts to interact with the RP using its Identity Wallet app. Authorization Code Flow is still a useful approach and should be used whenever the OP is known, and OP discovery is possible, e.g., exchanged or pre-populated DID Document containing an openid element in the service section. The SIOP flow allows to integrate Identity Wallets with plain OIDC clients if they implemented the SIOP specification. In contrast, using DID AuthN as the authentication means in the OIDC Authorization Code Flow would require integration with the OP vendor itself.
    </p>

    <figure id="protocol-flow">
        <img style="margin: auto; display: block; width: 100%;"
             src="assets/did_authn_siop_profile_flow.png" alt="Example SIOP flow with a mobile browser as the User-Agent and an Identity Wallet app as the SIOP.">
        <figcaption style="text-align: center;">
            Example SIOP flow with a mobile browser as the User-Agent and an Identity Wallet app as the SIOP.
        </figcaption>
    </figure>

    <section>
        <h2>Generate &lt;SIOP Request&gt;</h2>
        <h3>Redirect Request</h3>
        <p>
            The request contains scope, <code>response_type</code> and <code>client_id</code> as query string parameters for backward compatibility with the OAuth2 specification. <code>response_type</code> MUST be <code>id_token</code> and <code>client_id</code> MUST specify the callback URL of the RP (as per SIOP). All other OIDC request parameters MUST be provided in an Request Object which is encoded as a JWT. This enables the RP to authenticate against the SIOP using the RP's DID. The
            Request Object can be passed by value in the request request parameter, or by reference using the <code>request_uri</code> parameter.
        </p>

        <pre class="example nohighlight">
            openid://?response_type=id_token
                &client_id=https%3A%2F%2Frp.example.com%2Fcb
                &scope=openid%20did_authn
                &request=&lt;JWT&gt;
        </pre>

        <p>
            In the example above the DID AuthN <code>&lt;SIOP Request&gt;</code> is initiated by the RP using Request Object by value.
        </p>

        <pre class="example nohighlight">
            openid://?response_type=id_token
                &client_id=https%3A%2F%2Frp.example.com%2Fcb
                &scope=openid%20did_authn
                &request_uri=https%3A%2F%2Frp.example.com%2F90ce0b8a-a910-4dd0
        </pre>

        <p>
            In the example above the DID AuthN <code>&lt;SIOP Request&gt;</code> is initiated by the RP using Request Object by reference.
        </p>

        <h3>RP Meta-data</h3>
        <p>
            In contrast to other OIDC flows, e.g., Authorization Code Flow, RPs can provide client meta-data in the <code>registration</code> request parameter.
        </p>

        <p>
            In addition to <code>RS256</code>, an SIOP according to this specification MUST support <code>Ed25519</code> and <code>secp256k1</code> [[!draft-ietf-cose-webauthn-algorithms-02]] for <code>request_object_signing_alg</code> and <code>request_object_signing_alg</code> can be omitted. RPs implementing the DID AuthN profile MUST not use <code>none</code> for <code>request_object_signing_alg</code>.
        </p>

        <p>
            The Request Object MUST be directly or indirectly verifiable by a verification method in the RP's DID Document and directly by the RP's JWKS. The JWKS MUST be provided in the <code>jwks_uri</code> or <code>jwks</code> entry of the <code>registration</code> parameter. The JWKS MUST contain an entry with a <code>kid</code> that matches the <code>kid</code> in the Request Object. <code>jwks_uri</code> MUST use the HTTP(S) DID Resolution Binding for backward compatibility reasons with plain SIOP OPs. The <code>jwks</code> request parameter SHOULD be used only if the public key cannot be directly obtained from the DID Document.
        </p>

        <p>
            RPs can decide to receive the &lt;SIOP Response&gt; encrypted. To enable encryption, the registration parameter MUST use <code>id_token_encrypted_response_alg</code> and <code>id_token_encrypted_response_enc</code> according to OIDC Client Metadata.
        </p>

        <h3>Request Object</h3>
        <p>
            The Request Object follows the OIDC specification, e.g., adding <code>nonce</code>, <code>state</code>, <code>response_type</code>, and <code>client_id</code> parameters.
        </p>

        <p>
            This specification introduces additional rules for request parameters and claims in the Request Object:
        </p>

        <ul>
            <li>REQUIRED. <code>iss</code> MUST contain the DID of the RP that can be resolved to a DID Document. The DID Document MUST contain a verification method in the authentication section, e.g., public key, that allows the SIOP to verify the Request Object.</li>
            <p class="note">
                By default, the <code>iss</code> claim refers to the <code>client_id</code> but SIOP assumes that <code>client_id</code> is the callback URL of the RP. That is the reason why the DID is not encoded in the <code>client_id</code>. It is compliant with the OIDC specification to use different values for <code>iss</code> and <code>client_id</code>.
            </p>

            <li>REQUIRED. <code>kid</code> MUST be a DID URL referring to a verification method in the authentication section in the RP's DID Document, e.g., <code>did:example:0xab#key1</code>. The SIOP MUST be able to use that verification method to verify the Request Object directly or indirectly. Additionally, the referred JWKS in the <code>registration</code> parameter MUST contain an entry with the same <code>kid</code>.</li>
            <li>OPTIONAL. <code>did_doc</code> MUST contain the DID Document that corresponds to the DID in the <code>iss</code> claim.</li>
            <li>REQUIRED. <code>scope</code> MUST include <code>did_authn</code> to indicate the DID AuthN profile is used.</li>
            <li>REQUIRED. <code>registration</code> MUST be included in the Request Object</li>
            <li>OPTIONAL. <code>response_mode</code> specifies how the response is returned to the callback URL by the SIOP. SIOP implementing the DID AuthN specification MAY set the <code>response_mode</code> to <code>form_post</code>. <code>fragment</code> is the default Response Mode. RPs MUST take into consideration the platform of the User-Agent when specifying this request parameter.</li>
            <p class="note">
                See OAuth 2.0 Form Post Response Mode and OAuth 2.0 Multiple Response Type Encoding Practices for more information about <code>response_mode</code>.
            </p>

        </ul>

        <p>
            The following is a non-normative example of the JWT header of a Request Object:
        </p>
        <pre class="example nohighlight">
            {
               "alg": "secp256k1",
               "typ": "JWT",
               "kid": "did:example:0xab#veri-key1"
            }
        </pre>

        <p>
            The following is a non-normative example of the JWT payload of a Request Object without requesting <code>&lt;SIOP Response&gt;</code> encryption:
        </p>
        <pre class="example nohighlight">
            {
                "iss": "did:example:0xab",
                "response_type": "id_token",
                "client_id": "https://my.rp.com/cb",
                "scope": "openid did_authn",
                "state": "af0ifjsldkj",
                "nonce": "n-0S6_WzA2Mj",
                "response_mode" : "form_post",
                "registration" : {
                    "jwks_uri" : "https://uniresolver.io/1.0/identifiers/did:example:0xab;transform-keys=jwks",
                    "id_token_signed_response_alg" : [ "secp256k1", "Ed25519", "RS256" ],
                }
            }
        </pre>
    </section>

    <section>
        <h2>&lt;SIOP Request&gt; Validation</h2>
        <p>
            The SIOP MUST validate the &lt;SIOP Request&gt; by following the Self-Issued ID Token Validation rules.
        </p>
        <p class="note">
            The step described above ensures that the Request Object is verified according to the OIDC specification. This includes basic JWS verification.
        </p>

        <p>
            If scope contains the <code>did_authn</code> scope, the receiving SIOP MUST further validate the &lt;SIOP Request&gt; as follows in no particular order:
        </p>

        <ul>
            <li>If no <code>did_doc</code> is present, resolve the DID Document from the RP's DID specified in the <code>iss</code> request parameter.</li>
            <li>If <code>did_doc</code> is present, ensure this is a viable channel to exchange the RP's DID Document according to the applicable DID method.</li>
            <li>If <code>jwks_uri</code> is present, ensure that the DID in the <code>jwks_uri</code> matches the DID in the <code>iss</code> claim.</li>
            <li>Determine the verification method from the RP's DID Document that matches the <code>kid</code> of the &lt;SIOP Request&gt;.</li>
            <li>Verify the &lt;SIOP Request&gt; according to the verification method above. This step depends on the verification method in the authentication section in the DID Document and is out-of-scope of this specification.</li>
        </ul>

        <p class="note">
            If the key pair that signed the &lt;SIOP Request&gt; refers to the same key as indicated by the verification method, then no additional verification has to be done as the SIOP validation will verify the signature of the JWS.
        </p>

        <h2>Generate &lt;SIOP Response&gt;</h2>

        <p>
            The SIOP MUST generate and send the &lt;SIOP Response&gt; to the RP as described in the Self-Issued OpenID Provider Response section. The <code>id_token</code> represents the &lt;SIOP Response&gt; encoded as a JWS, or nested JWS/JWE.
        </p>

        <p>
            This specification introduces additional rules for claims in the <code>id_token</code>:
        </p>

        <ul>
            <li>REQUIRED. <code>sub_jwk</code> MUST contain a <code>kid</code> that is a DID URL referring to the verification method in the SIOP's DID Document that can be used to verify the JWS of the <code>id_token</code> directly or indirectly.</li>
            <li>REQUIRED. <code>did</code> MUST be the SIOP's DID.</li>
            <li>OPTIONAL. <code>did_doc</code> MUST be the SIOP's DID Document corresponding to <code>did</code> in JSON encoding.</li>
        </ul>

        <p class="note">
            The <code>sub_jwk</code> claim has to be provided for backward compatibility reasons. The verification method in the DID Document can be different from a public key and can use a <code>publicKey</code> property value other than <code>publicKeyJwk</code>.
        </p>

        <p>
            The following is a non-normative example of the JWT header of an <code>id_token</code> using no encryption:
        </p>

        <pre class="example nohighlight">
            {
                "alg": "secp256k1",
                "typ": "JWT",
                "kid": "did:example:0xab#key-1"
            }
        </pre>

        The following is a non-normative example of the unencrypted JWT payload of an <code>id_token</code>:
        <pre class="example nohighlight">
            {
               "iss": "https://self-issued.me",
               "nonce": "n-0S6_WzA2Mj",
               "exp": 1311281970,
               "iat": 1311280970,
               "sub_jwk" : {
                  "crv":"secp256k1",
                  "kid":"did:example:0xcd#verikey-1",
                  "kty":"EC",
                  "x":"7KEKZa5xJPh7WVqHJyUpb2MgEe3nA8Rk7eUlXsmBl-M",
                  "y":"3zIgl_ml4RhapyEm5J7lvU-4f5jiBvZr4KgxUjEhl9o"
               },
               "sub": "9-aYUQ7mgL2SWQ_LNTeVN2rtw7xFP-3Y2EO9WV22cF0",
               "did": "did:example:0xcd"
            }
        </pre>
    </section>

    <section>
        <h2>&lt;SIOP Response&gt; Validation</h2>

        <p>
            The RP MUST validate the &lt;SIOP Response&gt; as described in the Self-Issued ID Token Validation section. This includes:
        </p>

        <ul>
            <li>Optionally decrypting the JWE to obtain the JWS which contains the <code>id_token</code>.</li>
            <li>Verifying that the <code>id_token</code> was signed by the key specified in the <code>sub_jwk</code> claim.</li>
        </ul>

        <p>
            Additionally, the RP MUST validate the <code>id_token</code> against the SIOP's DID Document as follows:
        </p>

        <ul>
            <li>If no <code>did_doc</code> is present, resolve the DID Document from the SIOP's DID specified in the <code>did</code> claim.</li>
            <li>If <code>did_doc</code> is present, ensure this is a viable channel to exchange the SIOP's DID Document according to the applicable DID method.</li>
            <li>Determine the verification method from the SIOP's DID Document that matches the <code>kid</code> of the <code>sub_jwk</code> claim in the <code>id_token</code>.</li>
            <li>Verify the <code>id_token</code> according to the verification method above. This step depends on the verification method in the authentication section in the DID Document and is out-of-scope of this specification.</li>
        </ul>

        <p class="note">
            If the key pair that signed the <code>id_token</code> refers to the same key as indicated by the verification method, then no additional verification has to be done as the SIOP validation will verify the signature of the JWS.
        </p>
    </section>

    <section>
        <h2>SIOP Discovery</h2>
        <p>
            The SIOP specification assumes the following OP discovery meta-data:
        </p>
        <pre class="nohighlight">
            "id_token_signing_alg_values_supported": ["RS256"],
            "request_object_signing_alg_values_supported": ["none", "RS256"]
        </pre>

        <p>
            The DID AuthN profile assumes the following OP discovery meta-data:
        </p>
        <pre class="nohighlight">
            "id_token_signing_alg_values_supported": ["RS256", "secp256k1", "Ed25519"],
            "request_object_signing_alg_values_supported":
               ["none", "RS256", "secp256k1", "Ed25519"]
        </pre>

        <p>
            This change will allow DID AuthN enabled RPs to use additional signature algorithms commonly used amongst members of the SSI community.
        </p>

        <p class="note">
            "Self-Issued OpenID Provider Discovery" IS NOT normative and does not contain any MUST, SHOULD, or MAY statements. Therefore, using a different signing algorithmn than <code>RS256</code> shouldn't break the SIOP specification. An DID AuthN enabled RP would provide <code>id_token_signed_response_alg</code> to indicate which signature algorithms other than <code>RS256</code> are supported, and can assume that SIOP implementing the DID AuthN profile support any of the additional algorithms.
        </p>
    </section>
</section>

<section class="informative">
    <h1>UX Considerations</h1>

    <p>
        SIOP uses the custom URL scheme <code>openid://</code>. Mobile browsers would open the app that registered that scheme. Desktop browser extensions/ plugins have support for similar functionality. It is out of the scope of the spec under which circumstances a QR code will be rendered. One option will be to provide the QR code if the user is using the desktop browser, and no browser extension/ plugin is available.
    </p>

    <p>
        On Android, the user can choose which app should open if multiple apps registered the same custom URL scheme. On iOS, the behavior is undefined. One approach would be to check if the user is on an iOS device and then, won't render the button if this is a concern. A fallback on iOS could be the use of custom mime types, but unusual UX has to be considered. Note, this issue is not specific to SIOP only but affects all apps using custom URL schemes. In case a QR Code is used where the user has to open the app first and has to scan the QR Code, this issue is mitigated.
    </p>
</section>

<section class="informative">
    <h1>Security Considerations</h1>
    <h2>Threat: Interception of the Redirect URI</h2>
    <p>
        If an attacker can cause the &lt;SIOP Response&gt; to be sent a URI under his control, he will directly get access to the fragment carrying the <code>id_token</code>.
    </p>
    <p>
        This attack can be mitigated by hardening the RP, e.g., no support for the open redirector pattern.
    </p>

    <h2>Threat: Identity Token Leak in Browser History</h2>
    <p>
        An attacker could obtain the &lt;SIOP Response&gt; from the browser's history.
    </p>
    <p>
        This attack cannot be fully mitigated. It is RECOMMENDED to use short expiration times for <code>id_token</code>, and indicating that browsers should not cache the response.
    </p>

    <h2>Threat: Identity Token Leak to Third Party Scripts</h2>
    <p>
        It is relatively common to use third-party scripts on RP pages, such as analytics tools, crash reporting. The author of the application may not be able to be fully aware of the entirety of the code running in the application. When a &lt;SIOP Response&gt; is returned in the fragment, it is visible to any third-party scripts on the page.
    </p>
    <p>
        This attack could be mitigated by using trusted/ audited third party scripts on the RP's page, or browser-based app.
    </p>

    <h2>Countermeasures</h2>
    <p>
        Use <code>response_mode=form_post</code> whenever possible to mitigate the risks described above. Under some circumstances, e.g., this will not be possible as such in the case of purely decentralized apps (dApp).
    </p>

    <h2>Additional Security Considerations</h2>
    <p>
        The OWASP Foundation maintains a set of security recommendations and best practices for web applications, and it is RECOMMENDED to follow these best practices when creating an SIOP or RP based on this specification.
    </p>
</section>

<section class="informative">
    <h1>IANA Considerations</h1>
    <p>
        This specification registers the <code>did</code> and <code>did_doc</code> claims in the IANA JSON Web Token Claims registry defined in JWT.
    </p>
</section>

<section class="informative">
    <h1>OIDC Considerations</h1>
    <p>
        This specification aims to be backward compatible with existing OIDC clients and OPs that implement the SIOP specification. Although the SIOP specification is part of the OIDC core specification, it is not widely adopted yet. One of the reasons was that not many apps existed that provided functionality we can find in Identity Wallets. Nevertheless, SIOP uses the same or similar request and response messages and should be easy to allow OIDC vendors to upgrade existing OIDC clients to support SIOP.
    </p>
</section>

</body>

</html>